
// MicRecorder v2.2.0 (distilled)
window.MicRecorder = (function () {
  function OggRecorder(config) {
    this.config = config || {};
    this.stream = null;
    this.recorder = null;
  }

  OggRecorder.prototype.start = function () {
    return navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
      this.stream = stream;
        this.recorder = new MediaRecorder(stream, { mimeType: 'audio/webm; codecs=opus' })

      this.chunks = [];
      this.recorder.ondataavailable = e => this.chunks.push(e.data);
      this.recorder.start();
    });
  };

  OggRecorder.prototype.stop = function () {
    return new Promise(resolve => {
      this.recorder.onstop = () => {
          const blob = new Blob(this.chunks, { type: 'audio/webm;codecs=opus' });
        resolve([null, blob]);
        this.stream.getTracks().forEach(track => track.stop());
      };
      this.recorder.stop();
    });
  };

  return { OggRecorder };
})();
